<!DOCTYPE html>
<html>
    <head>
      <title>PD_07-Piotr_Krzeszewski</title>
      <script src="https://d3js.org/d3.v4.min.js"></script>
      <script>

      shows = [
      {"showname":"Godless", "premiere": "22 XI 2017", "trakt": 83, "rt": 90, "imdb": 86, "metacritic": 76, "poster": "https://lh3.googleusercontent.com/kyQiBsVGpQxfjNuvHQdrtuT7erGxUnSh2A5K6WjD7fCnyZMlf-JgFjw6dTuA6QbAcXeIKH-qxA4ww0k5s1AqBc_n5SP-KeavbL5n2PhWb8l26z9az96CTm5Iw-znZeCbmqIIjDsZcsPCa-GsQ1qrQ5HjWe1YsxkmBUPHWg772pTz4NvauHZOmEhgWAiJrQkDDno8qnXFIxz4AH-aHY8Bg_M8Ac_m-DxT3LbUHqckxmZVUXr69c6Dofn-3uoGynbyuOxYI1alTF0wRlIYdIoeU8FK4OdKYwW5MdkNe8wXvt3WCc8stKHUD5cMng-tJtHWge32LD2YehJbH9fhgoHIII6Wr-jAyZiM-KU_Zp5-iXBdiaMOq1vYUAuHpVHSrnQCCEA0i9Eur7ryRoS3NNBHNN5L2MTkIMKOkfyUmH4UTd9hOr0KCw_Rjqxex7uLLZQxvsh5tBZL-FXTl9qvgjAzfyGR-PzF4l9Wndt1NhnK2-38s5Z9Et6lY7LvNOwVgSsa3R7SGiegSuZ8FLUvl8_804Ud78Tk9l5YZSVwVtl7r1Q-UcqyQ3qG6T2FcVX0N10Id1mj7cJfkMIbz-TXiFqK1GbLu-fFeqXCc7xOssYL3A=w300-h450-no" },
      {"showname":"Runaways", "premiere": "21 XI 2017", "trakt": 80, "rt": 82, "imdb": 75, "metacritic": 68, "poster": "https://lh3.googleusercontent.com/pJN7cMSnSQaPT1MrDc9C3ssrLLx9t-nyyeN2ZZQhs3WRGDYUUV3dSmKqyArDf33GfCDIRja-OkUj_Jnn71Oax6U5hWmySlb69z29kusJX307cIZgGjMdRYKW01Ot5taRDMpv85_0GJmn_HHOPoyNSHXAv83cAmo2eceIkUfIdf28Ws_wWpIzvpkch-7ODooeyIGwXHL8fUPQjI2eBZ03icbzUDtFDYBderVPrzoyF-ql-9OCW-eGufKaV9ek7-ukLjocaTPOtlXfBGpUvLUwuOKPEyHJcfyW48_2tUU1GkJoXvKpVFg5Wz5yzmOv_8JAkJERS0gICRYZpOKLoUIR1MiwZs1tUrp-vzbF25LmU_DzX-ty3bwI3_sslH8JoMCPLw6YRIWEo6XPm0g3JvAWTtLlK-oxjI1_TnDy6AqySIpVwvKfpWwOJNkxCIJloRumfS7RfpZBNvexJggYOUXDwki03ziuCgo0uU7q0uF6mGrHVj7LkxptXKakOBULPlqyJqvAnPAzxhj1N-bAEWJaoOrVnk2VqAbcUAWHlIqDaEhEMP-8AhERY32mslGYPX_wKfjS-mUmVoS3QC9ITk9VT4H3MFFVt_CmE4w5nAXIZg=w300-h450-no" },
      {"showname":"Punisher", "premiere": "17 XI 2017", "trakt": 85, "rt": 61, "imdb": 90, "metacritic": 54, "poster": "https://lh3.googleusercontent.com/OaK12ada7JT3VUCKcn7p44XE1xQa3z8yP9v9483oTQ8hwm6SdMZVHLoD7KFCnFrXok5BQeZm1Uhkv1g7WoHmZwyZWGTOTPPhQmgxIg4ZVO5Dut6s2yl4oiVnlZNA2UGVuDzvIruZT2PLSiymDk4Se5CuBhyyrP7dpuMqxHuzCFrl_3uzhRPPzSOoCz_YsuXC7rhNogF4i6Z2i7IFAQRXimskv2KKkhA6nkK4xPnd4MUpFNL43EQ-dJLkk5ZuNXh3Mf5mkuK7Ad6NfiEu9hzn2NftHamJQe0cW6-JIl8gJMa56Xf3gk7myOtinxuTbRsMBFMwuTfvzu4Miod94lbeUUL4h0ANkyWHZdgtQu8iTLxsk5C5-iZTkm0yaotha9nP59xDwj77maIvVzngN5hl_mfDrnJ2QkY6FUT2vg86zovC6XRV_bUlSpMs3_Dak7wWTJ9539nFrnAb47EgCsIQGrtf4yfSeV7TSFaqMT5M0FDDXpxHgN8oo6nN70ccKV5ZZx9v8hQ8af6P1adN1AstWZacIgt2OYsJOWXwNMoaryxp7YP0awAZC9v1dnb6MsZi6XkpIBZOLqfhH5vyqNQJRFtaB_8Phw2sJOibYtA8cw=w300-h450-no" },
      {"showname":"Future Man", "premiere": "14 XI 2017", "trakt": 77, "rt": 77, "imdb": 81, "metacritic": 70, "poster": "https://lh3.googleusercontent.com/hV8g7poKzKmgcjRiPqS-4-mKPZW4qtOgtKOud2J5hNmx6jPbs8Q3Z1Yf5g1eVs9Qcn2ifz9qcCp_B0v1g3oDMNKT7MM_eBZiQWaAmv4M9MMzEcYJkn9GjSq97ItrhGYiDdHcpEReGdUm_8RvHlG3-W02P49G_U6ktqvCzZY4fe1wHzh6enTQc74Tni2FydhP28pRCECeKOfGt_rAbBTnG4FGFcUwI_IKPv_BcQx4P5AoReyDwMI5FLEJtdRnvdfbVbRXOXdQ_O7P6bo1fkCRIqCd_-ytLPkkDoyG3XxtYAliVOzpqezjUuLAH-N4YfeSmQQLjdehPAaU164jZ_YsyRMJotMptH7y63VtulX6r_rIWzOxt3jyV_Tp_Byk1YOQdl5s1mfeMeAtcJmLsioKVoUAEKHCwVz1N2tsha0U8qCwo7HznidLZzzr92N3zFQHJ3DOzZ1FMfnR5UNjlft5gnpvnPMNHxsPIIb0TNjKUGaE4kE42pWtyl0pdZdF6e48Q1aEd7b9xgxTeDR9EX83_EZW7sxFVbYBC52OiXClkWs65oS6ID7hLdhj7GyUQ4ypCISYcGC-ZJTQgQstf99T0HqpXR5JasGuIBnmAiKhDw=w300-h450-no" },
      {"showname":"The Long Road Home", "premiere": "8 XI 2017", "trakt": 87, "rt": 82, "imdb": 74, "metacritic": 80, "poster": "https://lh3.googleusercontent.com/i1ogjADyz3n6ni6YA1C68c-ODRnS6I0Ut7DqQpTxBfnFyXmd7-lRjf02LQ2x_iNElylduT-4Bspn1efI6pt5sotqgv6KYC1GexLiUtekxaiE0n68ZSM4pRFtBuXcHzQXJF_JKudSvuu5rGPwUWZPBgVMgTQ8ibdhnGH2BFNGCJj_U-Q7hIfDV_ZtI6wmSXAfRMC_2Xar5DVaV7mAUFxG2q-586gWQGwC_N1C57PM6benc_KzlR5qoH6OwsFoGNvXSXl0j2z5AXb7Bhwe-UKPUwelyNn0AORRrKlvDR14GA9IapvjsolvGYU0C1lICrou4ZIcEGW1iOis7Lcm8bWyYF6yX1RdL8dgCMmtqtkrEq_5Yvr7mdeXdXVj8pdgjQ8QFB9CFQT5Dg2sqooV1hjHLKN7h4ZWwdka-HzJS1WTpCirvFZ9PTX2jZt0A3AEzKiTB_SkIik3o_tfEn6RAE55K1TW6b_NZOg3PA0elLbfNs1w2QSK8c3BJLFgiTLfv1QEJsesmKhgmW5wA7UOUmnGRa-HvLUP5hEHD3NrZQ6ZdPmi6rLRx-W4-zrAxAo-C8CrO864JK9OdfvcW_wl-kWRFjeXUo1RhnRgLxg8pL_UHQ=w300-h450-no" },
      {"showname":"SMILF", "premiere": "5 XI 2017", "trakt": 72, "rt": 71, "imdb": 63, "metacritic": 63, "poster": "https://lh3.googleusercontent.com/8tGIXhODX9bvig2XxkxGKDQolwKk-qpsqMTtWDRwXLT2biI5rEjUoAS8OBb0KUUqk7__L0F5Zj5L22AgKtIIT6kLmQBboCzFxLfoibXyFMh4KwWgAN3zurxh16ESfFGAtJE0k_0xSPEXnUfRjs7t4jS5sicaTOSTcry2haEgiZJLR1Jdd2Qbs8kaip516ILAI63HCG9in3nNlYZubhD9z8aw7agPplA06fMOy7lnvyAfsB3yqeXweNreK_CHeDmunHYPkkUyjsACECfcbJE911JOFZ2mAp1Fz58otKntDCdgNU3YzzISOg6s1cEAz0zeOcHBEYnsbAhZw8KBnMSZ6pugwcg8I-R35hmbsCR2JikuPg-LN3C2FK3HsMM_vhiY2jbKOrUL12MuNqY955_tToz_pWAZb_QXe8BbtN6UMAF1bbG2LC4UpeesWRvb3W4qxLqcl6ZKAfZkgUwOu81RGMszM3tAqn3UBQxc8yQoS2Pu4t0CzqqiLgLAVEbF3MSfV6EnhFa7Y79r7c8fwSn2-0Id8af8_m41Vsv2AgaWFDt7ZRLU1ZWPJ_kfEgtEuQEe3CrBp1TjK82YWbmxYnlQuD-W-dNSUzbAtew7Sy_SGQ=w300-h450-no" },
      {"showname":"S.W.A.T.", "premiere": "2 XI 2017", "trakt":79, "rt": 45, "imdb":59, "metacritic": 45, "poster": "https://lh3.googleusercontent.com/x2Ur4BcYL7fK4Kizz9FR26nRCTHuVS61qSg4Ep0nkQBIV1pO3D4DpM1HWIZ0BEBmLHmLilKCBO_yCLX36U10pV0CaAqgTXxNFJU2N5CRDqG_ua2xT5QRK6jkAdi5Qr86lIPoeybOyK7L8aRPdHh76nTcI8_YoB5ZklQKmQx3XW-hcovYvHkzGbrEZBh2uHRFmuxS4tpXfQK91DVvDWjiPljL7sRo1r6r7aoGTNRF6AJfVI21agY5NVFmCwd5fduHRjcBOYUviYdNpDGnqkAZAF9q0xDl8RewA3oI1gwiLq6PxB3aNgeS6Hss03gqhWg_dCaRPW6G2qUBlTaEdWIFGMSSnyK8dba20_t3eyw6WkhtZdnVadaYzSyi0nvXu5wf0oolwa40DvLJdNdbIk9ERstvjujKFLWdA6DZjcO2YX70MYABrsomloA1o_agmm1PWFODCLX_nCImvpEAg_4kmiyXvDpj4YWZYCT8c4PmGdlf8-CCHQgmSCpndaB-pjKzC-etmbLNTA-MEn2CI8h2omL7cG9Dh_Wt2In7yAGyfbgxxdkUzFMru-eJDvA7Q9kmJ6s2tNGH0w8ZcEQHwhrb2Z0glG-auIh9uQHP-IYOzQ=w300-h450-no" },
      {"showname":"She's Gotta Have It", "premiere": "23 XI 2017", "trakt": 76, "rt": 88, "imdb": 69, "metacritic": 77, "poster": "https://lh3.googleusercontent.com/2_R5v1YQy4xHwQGHwPyRk0z7kLqOMwAlJezvBNjN9YhIoPjjbOr-vdULLxXboB0hFQA3TzhWzchZBY-byPLjF8akndU45Oru2nX4zTMAuMOUMwChTuR9jHi12_y7g7fbjhilpG3jBV0ZNlIUXlo9GBL5IVy-bkRipVkJ9EMVRpDXnrZUj1i2GUlU5bkPaWVI0vKgbkZbbeGMV2lkYF__VnkXLNzocCOs5dz_nHwQHytB8E9hWYIEyS-nevdKSGIgPGxILH1Rpaz5OxwE2qBkxmxKomO-if89AlWbjIDI4hpSGFfOvmdb9ViCJZevfS2GWY8BXuatcdGg63cpY5iEG_iHAuctgkD032Ic_WfhAAGx9jIQ6FLO5eNGpF-AlD3qTlsDxDQ91F-jcM8KCE3zmt6C-VaMv91ji54kXhYmqfJXEnrFE9jMD9woc7lopgFvq44GPiIyLpIwVuQ_qtpa6Hm7LLiN2eubZPUWh7w4-1WgoHFW7461tHY6mjyYxOpGYyPuoLW5Tiax-vJkuygZXSyayKSwgRdvCC9jX5KPaqSWz4o1TvddG268_5GallpsDwjggEWFqsW_3ks0hwx847wf3BiuptlHnCNitGSOXw=w300-h450-no" }
      ]

      transition_time = 1500

      var point_scale = d3.scaleLinear()
      	.domain([0, 100])
        .range([0, 500])

      function calculate_points(d, method) {
        if (method === "avg")
          return cal_average(d)
        else return d[method]
      }

      function cal_average(d) {
         return (d.trakt + d.imdb + d.rt + d.metacritic) / 4
      }

      function draw_data(method, color) {

        shows.sort(function(a, b){
          var keyA = calculate_points(a, method),
              keyB = calculate_points(b, method);
          // Compare the 2 dates
          if(keyA < keyB) return 1;
          if(keyA > keyB) return -1;
          return 0;
        });

        draw_data_title(method, color)
        draw_data_posters(method, color)
        draw_data_names(method, color)
        draw_data_premieres(method, color)
        draw_data_pts(method, color)
      }

      function draw_data_title(method, color) {
        var d_title = d3.select("g.title")
        var title = d_title.selectAll("text").data([0])
        title
          .text(function(d, i) {return "Listopad 2017 w serialach (" + method + ")"})
          .attr("x", 120)
          .attr("y", 30)
          .attr("font-size", 30);
      }

      function draw_data_posters(method, color) {
        var d_posters = d3.select("g.posters")
        var posters = d_posters.selectAll("image").data(shows, function(d, i) {return d.showname})

        //UPDATE
        posters
          .transition()
          .duration(transition_time)
          .attr("y", function(d, i) { return 50 + i * 110 + 5})

        //CREATE
        posters.enter().append("image")
          .attr("x", 20)
          .attr("y", function(d, i) { return 50 + i * 110 + 5})
          .attr("height", 100)
          .attr("width", 70)
          .attr("xlink:href", function(d, i) {return d.poster} )
      }

      function draw_data_names(method, color) {
        var d_names = d3.select("g.names")
        var names = d_names.selectAll("text").data(shows, function(d, i) {return d.showname})

        //UPDATE
        names
          .transition()
          .duration(transition_time)
          .attr("y", function(d, i) { return 50 + i * 110 + 25})

        //CREATE
        names.enter().append("text")
          .text(function(d, i) { return d.showname })
          .attr("x", 100)
          .attr("y", function(d, i) { return 50 + i * 110 + 25})
          .attr("font-size", 24)
          .attr("font-weight", "bolder")
      }

      function draw_data_premieres(method, color) {
        var d_premieres = d3.select("g.premieres")
        var premieres = d_premieres.selectAll("text").data(shows, function(d, i) {return d.showname})

        //UPDATE
        premieres
          .transition()
          .duration(transition_time)
          .attr("y", function(d, i) { return 50 + i * 110 + 45})

        //CREATE
        premieres.enter().append("text")
          .text(function(d, i) { return d.premiere })
          .attr("x", 110)
          .attr("y", function(d, i) { return 50 + i * 110 + 45})
          .attr("font-size", 16)
          .style("fill", "gray")
      }

      function draw_data_pts(method, color) {
        var d_pts = d3.select("g.pts")
        var pts = d_pts.selectAll("rect").data(shows, function(d, i) {return d.showname})

        // UPDATE
        pts
          .transition()
          .duration(transition_time)
          .attr("y", function(d, i) { return 50 + i * 110 + 65})
          .attr("width", function(d, i) { return point_scale(calculate_points(d, method))})
          .style("fill", color)

        //CREATE NEW
        pts.enter().append("rect")
          .attr("x", 100)
          .attr("y", function(d, i) { return 50 + i * 110 + 65})
          .attr("width", function(d, i) { return point_scale(calculate_points(d, method))})
          .attr("height", 30)
          .style("fill", color)

        var d_ptstxt = d3.select("g.ptstxt")
        var ptstxt = d_ptstxt.selectAll("text").data(shows, function(d, i) {return d.showname})

        //UPDATE
        ptstxt
          .transition()
          .duration(transition_time)
          .text(function(d, i) { return calculate_points(d, method) + ""})
          .attr("x", function(d, i) { return point_scale(calculate_points(d, method)) + 105})
          .attr("y", function(d, i) { return 50 + i * 110 + 85})

        //CREATE
        ptstxt.enter().append("text")
          .text(function(d, i) { return calculate_points(d, method) + ""})
          .attr("x", function(d, i) { return point_scale(calculate_points(d, method)) + 105})
          .attr("y", function(d, i) { return 50 + i * 110 + 85})
          .attr("font-size", 20)
          .style("fill", "darkgray")
      }

      //sortAverage()

      function sortAverage() {
         draw_data("avg", "DarkViolet")
      }

      function sortRT() {
         draw_data("rt", "OrangeRed")
      }

      function sortMetacritic() {
         draw_data("metacritic", "SeaGreen")
      }

      function sortIMDb() {
         draw_data("imdb", "DarkGoldenRod")
      }

      function sortTrakt() {
         draw_data("trakt", "FireBrick")
      }

      </script>
    </head>
    <body onload="sortAverage()">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

      <h1>Najważniejsze seriale listopada 2017</h1>
      <h3>TWD - 07</h3>

      <p>Poniższy dokument prezentuje subiektywny wybór najważniejszych seriali zaprezentowanych w listopadzie na ekranach telewizyjnych całego świata. Za seriale z tego okresu uznano te, których data pierwszej premiery miała miejsce w listopadzie 2017r.</p>

      <p>Seriale są opisywane przez oceny (w skali 0-100) z najważniejszych serwisów o tematyce filmowo-telewizyjnej. Za takie serwisy uznałem <strong>RottenTomatoes</strong>, <strong>Metacritic</strong>, <strong>IMDb</strong> oraz <strong>Trakt.tv</strong>. Dane zaczerpnąłem ze stron tych serwisów w dniu 30 XI 2017.</p>

      <p>Prezentacja wykorzystuje możliwości <em>D3.js</em> i pozwala na wykonanie podstawowych animacji. Przyciski pozwalają na wybranie preferowanego sortowania programów.</p>

      <h4>Posortuj seriale według oceny:</h4>
      <button type="button" onclick="sortAverage()">Średnia ocena</button>
      <button type="button" onclick="sortRT()">RottenTomatoes</button>
      <button type="button" onclick="sortMetacritic()">Metacritic</button>
      <button type="button" onclick="sortIMDb()">IMDb</button>
      <button type="button" onclick="sortTrakt()">Trakt</button>
      <div class="output">
      <svg width=650 height=1000>
        <g class="title">
          <text/>
        </g>
        <g class="posters"></g>
        <g class="names"></g>
        <g class="premieres"></g>
        <g class="pts"></g>
        <g class="ptstxt"></g>
      </svg>
      </div>

      <h3>Źródła danych:</h3>

      <i class="fa fa-star"> </i> <a href="https://trakt.tv">Trakt.tv</a><br/>
      <i class="fa fa-star"> </i> <a href="https://imdb.com">IMDB.com</a><br/>
      <i class="fa fa-star"> </i> <a href="https://rottentomatoes.com">RottenTomatoes.com</a><br/>
      <i class="fa fa-star"> </i> <a href="https://metacritic.com">Metacritic.com</a>

    </body>
</html>
